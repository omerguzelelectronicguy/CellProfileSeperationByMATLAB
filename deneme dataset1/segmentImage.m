function [BW,maskedImage] = segmentImage(RGB)
%segmentImage Segment image using auto-generated code from imageSegmenter app
%  [BW,MASKEDIMAGE] = segmentImage(RGB) segments image RGB using
%  auto-generated code from the imageSegmenter app. The final segmentation
%  is returned in BW, and a masked image is returned in MASKEDIMAGE.

% Auto-generated by imageSegmenter app on 31-May-2021
%----------------------------------------------------


% Convert RGB image into L*a*b* color space.
X = rgb2lab(RGB);
gaborX = createGaborFeatures(X);

% Create empty mask.
BW = false(size(X,1),size(X,2));

% Draw ROIs

xPos = [35.9057 13.5183 12.3702 12.3702 12.3702 12.3702 12.3702 12.3702 12.3702 14.6663 16.3884 18.6846 21.5548 26.1471 29.0172 31.8874 33.6095 35.3316 35.9057 39.9239 43.3682 46.2383 48.5345 50.8306 54.8489 56.5710 57.1450 58.8671 61.7373 64.0335 65.1815 65.7556 66.3296 66.9037 67.4777 68.0517 68.0517 69.1998 69.1998 69.1998 69.1998 69.1998 69.1998 69.1998 68.0517 66.9037 66.3296 65.1815 62.8854 61.7373 58.8671 54.8489 49.1085 43.3682 40.4980 39.9239 39.3499 38.2018 36.4797 35.9057 35.9057 35.0000 35.0000];
yPos = [62.2089 50.1542 49.0061 47.2840 44.9878 44.4138 41.5436 36.9513 31.7850 27.7667 24.3225 21.4523 18.0081 15.1379 13.4158 11.6937 11.1197 10.5456 10.5456 9.9716 8.8235 7.6755 7.6755 6.5274 5.9533 5.9533 5.9533 5.9533 6.5274 10.5456 13.4158 14.5639 16.8600 20.8783 24.3225 26.6187 27.7667 29.4888 31.7850 35.2292 38.6734 39.8215 42.1176 43.8398 45.5619 47.2840 49.0061 50.1542 50.7282 52.4503 53.5984 55.3205 57.0426 58.1907 58.7647 59.3387 59.3387 59.9128 60.4868 61.0609 61.6349 60.7013 60.2987];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [155.3053 148.4168 146.1207 143.8245 142.6765 142.1024 142.1024 141.5284 141.5284 141.5284 142.1024 142.6765 143.2505 143.8245 144.9726 145.5467 146.1207 146.1207 146.1207 147.2688 147.2688 147.8428 147.8428 148.4168 149.5649 149.5649 150.1389 150.1389 150.7130 152.4351 154.1572 155.8793 157.6014 158.7495 159.8976 160.4716 161.6197 161.6197 162.1937 162.7677 162.7677 163.3418 163.9158 164.4899 165.0639 165.6379 166.2120 167.3600 167.9341 168.5081 169.6562 170.2302 171.9523 173.6744 176.5446 177.6927 179.4148 181.1369 181.7110 181.7110 181.7110 181.7110 181.7110 181.1369 179.9888 178.8408 177.6927 176.5446 175.3966 175.3966 174.8225 174.2485 172.5264 171.3783 169.6562 169.6562 168.5081 167.9341 166.2120 162.1937 157.0274 155.3053 153.0091 151.2870 150.1389 149.5649 149.5649 150.7130 151.2870 153.0091 153.5832 154.1572 154.7312 155.3053 154.7312 154.1572 155.4468 155.8494];
yPos = [107.5578 100.0953 96.0771 91.4848 87.4665 84.5963 81.7262 79.4300 78.8560 78.2819 78.2819 78.2819 78.2819 78.2819 78.2819 78.2819 77.7079 77.1339 76.5598 75.4118 74.8377 74.2637 73.1156 71.3935 70.2454 69.6714 69.6714 68.5233 67.3753 65.6531 63.3570 61.0609 58.7647 57.0426 55.3205 54.1724 54.1724 53.5984 53.0243 53.0243 52.4503 51.3022 50.1542 48.4320 47.8580 47.8580 47.8580 47.2840 47.2840 47.2840 47.2840 47.2840 47.2840 47.2840 49.5801 51.8763 55.8945 60.4868 63.9310 67.3753 73.1156 77.7079 81.7262 85.7444 88.6146 92.6329 97.2252 100.6694 102.3915 103.5396 104.6876 106.9838 108.7059 109.8540 111.0020 111.5761 112.1501 112.1501 112.1501 112.1501 112.7241 112.7241 112.7241 112.7241 112.1501 111.5761 111.0020 111.0020 110.4280 109.8540 109.2799 108.7059 108.7059 108.1318 108.1318 108.1318 107.1506 107.5532];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [135.7880 134.0659 133.4919 133.4919 133.4919 133.4919 133.4919 133.4919 134.0659 135.2140 136.9361 138.0842 139.2323 140.3803 140.9544 142.1024 142.6765 143.2505 145.5467 146.6947 148.4168 148.9909 150.7130 153.0091 154.7312 155.8793 156.4533 157.6014 158.1755 158.7495 159.8976 160.4716 162.1937 163.3418 164.4899 164.4899 165.6379 166.2120 166.7860 166.7860 167.3600 167.9341 167.9341 168.5081 168.5081 168.5081 168.5081 168.5081 168.5081 168.5081 167.9341 166.7860 165.6379 163.9158 161.6197 158.1755 155.3053 151.8611 150.1389 147.8428 147.2688 146.6947 146.1207 145.5467 143.8245 143.2505 142.6765 141.5284 140.3803 138.6582 137.5101 136.9361 136.3621 135.7880 135.2140 134.0659 134.0659 134.0659 134.0659];
yPos = [75.9858 72.5416 71.3935 69.6714 66.8012 65.0791 63.3570 61.6349 59.9128 58.1907 55.8945 54.1724 53.5984 52.4503 51.8763 51.3022 50.7282 50.1542 48.4320 48.4320 48.4320 47.2840 47.2840 47.2840 47.2840 47.2840 47.2840 47.2840 47.2840 47.8580 48.4320 49.0061 50.7282 51.8763 53.0243 53.5984 54.7465 55.8945 57.0426 58.1907 59.3387 61.0609 63.3570 65.6531 67.3753 68.5233 70.2454 71.3935 72.5416 73.1156 73.1156 73.1156 74.2637 74.2637 74.8377 74.8377 74.8377 74.8377 74.8377 75.4118 75.4118 75.9858 76.5598 76.5598 77.1339 77.7079 77.7079 77.7079 77.7079 77.7079 77.7079 77.7079 77.7079 77.7079 77.7079 77.7079 77.1339 75.9858 75.4118];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [117.4189 114.5487 110.5304 104.2160 96.1795 93.8834 93.3093 92.7353 92.1613 91.5872 91.0132 91.0132 91.0132 91.0132 91.5872 92.7353 94.4574 96.7535 98.4757 102.4939 107.0862 112.2525 115.6968 116.2708 116.8448 117.9929 119.7150 121.4371 123.1592 123.1592 124.3073 124.8813 125.4554 126.0294 126.6034 127.1775 127.7515 127.7515 127.7515 128.3256 128.3256 128.3256 128.3256 128.3256 128.3256 128.3256 127.7515 127.1775 125.4554 120.8631 116.2708 113.4006 112.2525 111.6785 111.1045 110.5304 111.1045 111.1045 112.2987 112.7013 112.2442 112.4571 112.5429 112.7558];
yPos = [143.1481 143.7221 143.7221 143.7221 141.4260 140.8519 140.2779 137.9817 133.9635 130.5193 125.9270 123.0568 121.9087 120.1866 119.6126 117.8905 116.7424 114.4462 113.2982 112.7241 112.1501 111.0020 110.4280 110.4280 110.4280 110.4280 110.4280 112.1501 115.0203 116.7424 118.4645 120.7606 121.9087 124.2049 127.0751 130.5193 132.8154 134.5375 136.2596 137.4077 139.1298 140.8519 142.5740 143.7221 144.2961 144.8702 145.4442 145.4442 145.4442 145.4442 145.4442 145.4442 145.4442 144.2961 144.2961 143.7221 144.2961 143.7221 143.0000 143.0000 141.6468 141.0000 140.3532 140.0545];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [109.3824 80.6805 79.5325 79.5325 79.5325 79.5325 79.5325 79.5325 79.5325 79.5325 79.5325 79.5325 79.5325 80.1065 80.1065 81.8286 81.8286 82.4026 82.9767 83.5507 84.1247 84.1247 84.6988 84.6988 85.2728 85.8469 86.9949 87.5690 89.2911 92.1613 93.8834 96.1795 96.7535 99.0497 100.1978 102.4939 103.0680 104.2160 104.7901 105.9381 107.6602 107.6602 108.8083 109.3824 109.9564 109.9564 111.1045 111.1045 111.1045 111.1045 111.1045 111.1045 111.1045 111.1045 111.1045 111.1045 111.1045 111.1045 111.1045 111.1045 111.1045 111.1045 111.1045 111.1045 110.5304 110.5304 109.9564 109.9564 109.3824 109.3824];
yPos = [172.9980 164.9615 163.2394 160.9432 157.4990 155.7769 152.3327 148.8884 146.5923 146.0183 144.8702 143.1481 141.4260 139.7039 137.9817 136.8337 135.1116 133.9635 132.8154 132.2414 132.2414 131.0933 131.0933 130.5193 130.5193 130.5193 129.9452 129.9452 129.9452 129.9452 129.9452 129.9452 129.9452 131.0933 132.2414 134.5375 136.2596 138.5558 140.8519 142.5740 146.0183 148.3144 149.4625 151.1846 151.7586 152.9067 155.2028 156.9249 158.0730 158.6471 159.7951 160.3692 162.0913 162.6653 163.2394 163.8134 164.3874 164.9615 165.5355 166.1095 167.2576 167.8316 168.4057 169.5538 170.1278 170.7018 170.7018 171.2759 171.2759 171.8499];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [64.6075 61.7373 60.0152 58.2931 55.9970 53.7008 53.1268 51.4047 50.8306 49.1085 47.9604 47.3864 46.8124 46.2383 44.5162 43.9422 42.2201 42.2201 42.2201 42.2201 42.2201 42.2201 42.2201 42.2201 42.2201 42.2201 42.2201 43.3682 43.3682 43.3682 44.5162 45.0903 45.0903 46.8124 48.5345 50.2566 50.8306 52.5527 53.1268 54.2748 55.4229 55.9970 57.7191 58.2931 60.0152 60.5892 62.3114 62.8854 64.6075 65.7556 66.3296 67.4777 68.6258 70.9219 71.4959 72.0700 73.2181 73.7921 74.9402 76.0882 77.2363 78.9584 79.5325 81.8286 82.4026 82.9767 84.6988 85.8469 87.5690 89.2911 90.4391 91.0132 91.0132 91.5872 92.1613 92.1613 92.7353 92.7353 92.7353 92.7353 92.1613 91.5872 91.0132 89.2911 88.1430 87.5690 86.9949 85.8469 84.1247 78.3844 74.9402 73.2181 72.6440 71.4959 70.9219 69.1998 68.0517 66.3296 65.7556 64.0335 63.4594 62.3114 62.3114 61.2987 61.7013];
yPos = [139.1298 138.5558 137.4077 135.6856 133.3895 131.6673 131.6673 130.5193 129.9452 128.7972 127.0751 126.5010 126.5010 125.9270 124.2049 121.9087 119.6126 118.4645 116.7424 116.1684 115.5943 115.0203 114.4462 113.2982 112.1501 111.0020 110.4280 109.8540 109.2799 108.1318 108.1318 107.5578 106.4097 105.2617 104.1136 103.5396 102.9655 102.3915 102.3915 101.8174 101.8174 101.8174 101.8174 101.8174 101.8174 101.8174 101.8174 101.8174 101.8174 101.8174 101.8174 101.8174 102.3915 102.3915 102.3915 102.3915 103.5396 104.1136 104.6876 105.2617 105.8357 106.9838 107.5578 109.2799 110.4280 111.0020 112.1501 113.8722 114.4462 115.5943 116.7424 117.3164 117.8905 117.8905 118.4645 119.0385 120.7606 123.0568 126.5010 128.7972 131.0933 132.8154 133.3895 135.6856 137.4077 137.9817 138.5558 139.1298 139.1298 139.1298 139.1298 139.1298 139.1298 139.1298 139.1298 139.1298 139.1298 139.1298 139.1298 139.7039 140.2779 140.2779 140.8519 139.7013 139.2987];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [35.9057 31.8874 30.7394 28.4432 27.8692 23.8509 22.1288 20.4067 16.9625 14.0923 12.3702 11.7961 11.2221 9.5000 7.2039 4.9077 3.1856 2.6116 2.0375 0.8895 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.8895 5.4817 6.6298 7.7779 8.3519 10.0740 11.2221 14.0923 15.2404 15.8144 16.9625 18.1105 19.2586 20.9807 22.7028 24.4249 25.5730 26.7211 27.2951 27.2951 27.8692 28.4432 28.4432 29.0172 29.0172 29.0172 29.5913 29.5913 30.1653 30.1653 30.7394 31.3134 31.3134 31.3134 31.8874 31.8874 32.4615 32.4615 32.4615 32.4615 32.4615 32.4615 32.4615];
yPos = [155.7769 155.7769 155.7769 155.7769 155.7769 155.7769 156.3509 156.9249 157.4990 157.4990 157.4990 157.4990 157.4990 157.4990 157.4990 157.4990 157.4990 157.4990 157.4990 157.4990 156.3509 155.2028 153.4807 151.1846 148.8884 147.1663 146.5923 145.4442 144.2961 142.0000 140.2779 139.7039 138.5558 137.4077 136.8337 135.6856 134.5375 133.9635 132.8154 132.2414 132.2414 132.2414 132.2414 132.2414 132.2414 132.2414 132.2414 132.8154 133.9635 133.9635 135.1116 135.6856 136.8337 137.4077 137.9817 139.1298 140.2779 140.8519 142.0000 143.1481 143.7221 144.8702 145.4442 146.5923 147.1663 147.7404 148.3144 148.8884 149.4625 150.0365 151.1846 151.7586 152.3327 152.9067 153.4807 154.0548 154.6288 155.2028 155.7769];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [49.1085 38.2018 36.4797 34.7576 30.7394 24.9990 21.5548 20.9807 20.4067 20.4067 19.8327 18.6846 18.6846 18.1105 18.1105 18.1105 17.5365 17.5365 17.5365 17.5365 17.5365 17.5365 17.5365 17.5365 18.1105 19.2586 19.8327 21.5548 23.2769 24.9990 27.2951 29.5913 31.8874 33.6095 34.7576 35.9057 37.0538 37.6278 38.2018 39.9239 41.0720 42.7941 43.3682 43.9422 43.9422 43.9422 44.5162 45.6643 45.6643 45.6643 46.2383 46.2383 46.2383 46.2383 46.2383 46.8124 47.3864 47.3864 47.3864 47.3864 47.9604 47.9604 47.9604 47.9604];
yPos = [206.2921 206.2921 206.2921 206.2921 205.1440 201.6998 199.9777 198.8296 197.6815 195.3854 193.0892 190.7931 189.6450 187.9229 186.2008 185.0527 183.9047 182.7566 180.4604 178.7383 178.1643 177.5903 177.0162 176.4422 176.4422 176.4422 175.8682 175.8682 175.8682 175.8682 175.8682 174.7201 174.1460 174.1460 174.1460 174.1460 174.1460 174.1460 174.1460 175.8682 178.1643 179.8864 181.0345 181.6085 182.1826 183.3306 183.9047 185.6268 186.7748 187.9229 189.0710 190.2191 191.9412 194.2373 194.8114 197.1075 198.8296 199.9777 201.1258 201.6998 202.2738 202.8479 203.4219 203.9959];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [86.9949 82.4026 80.6805 77.2363 75.5142 73.7921 73.2181 72.6440 72.6440 72.6440 72.6440 72.6440 72.6440 72.6440 72.6440 74.9402 78.3844 84.1247 86.4209 92.7353 93.3093 100.1978 104.2160 108.2343 111.1045 111.1045 113.9746 117.4189 119.1410 120.8631 121.4371 122.5852 122.5852 122.5852 122.5852 122.5852 121.4371 119.7150 117.9929 116.8448 114.5487 111.6785 108.8083 105.9381 101.9199 100.1978 96.7535 94.4574 92.1613 88.7170 88.1430 87.5690 87.5690 89.0000 89.0000];
yPos = [218.9209 213.7546 211.4584 206.8661 204.5700 202.8479 202.2738 201.6998 199.9777 198.2556 197.6815 195.3854 192.5152 190.2191 187.9229 185.0527 182.1826 181.6085 181.6085 181.6085 181.6085 183.9047 185.0527 186.7748 187.9229 188.4970 189.6450 192.5152 194.8114 197.1075 199.4037 202.8479 204.5700 207.4402 209.7363 210.8844 212.6065 213.7546 214.9026 215.4767 216.0507 216.6247 217.7728 218.3469 220.0690 220.0690 220.6430 221.2170 221.2170 221.7911 221.7911 221.7911 220.6430 219.7013 219.2987];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [109.9564 98.4757 91.5872 85.8469 83.5507 82.9767 81.8286 81.2546 80.1065 80.1065 80.1065 80.1065 80.1065 80.1065 80.6805 81.2546 81.8286 81.8286 82.9767 83.5507 85.8469 88.1430 91.0132 93.3093 94.4574 96.1795 96.7535 99.0497 100.7718 102.4939 104.2160 106.5122 108.2343 109.3824 110.5304 113.4006 116.2708 119.1410 120.2890 121.4371 122.5852 123.7333 124.3073 124.8813 124.8813 125.4554 125.4554 126.0294 126.0294 127.1775 127.1775 127.1775 127.1775 126.6034 126.0294 125.4554 124.8813 124.3073 123.1592 122.5852 121.4371 119.7150 116.8448 113.9746 111.6785 111.6785 111.1045];
yPos = [276.3245 274.0284 272.8803 270.5842 268.8621 267.1400 264.8438 261.9736 256.8073 248.1968 243.0304 238.4381 234.9939 232.6978 229.8276 229.2535 228.6795 226.9574 226.3834 225.2353 224.6613 224.0872 224.0872 224.0872 223.5132 222.9391 222.9391 222.3651 222.3651 221.2170 221.2170 221.2170 221.2170 221.2170 222.3651 224.0872 227.5314 230.4016 231.5497 232.6978 233.8458 235.5680 237.2901 239.0122 241.3083 245.3266 248.1968 250.4929 252.7890 256.2333 259.1034 262.5477 265.4178 268.2880 270.0101 271.1582 271.1582 271.7323 272.3063 272.3063 272.3063 272.8803 274.0284 274.0284 274.6024 275.1765 276.3245];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [171.3783 163.9158 158.7495 155.8793 154.1572 151.8611 150.1389 148.9909 148.4168 146.6947 146.6947 143.8245 141.5284 140.3803 139.8063 139.8063 139.2323 138.6582 138.6582 138.6582 138.6582 138.6582 138.6582 138.6582 139.2323 140.3803 141.5284 142.1024 143.2505 143.8245 143.8245 144.3986 146.1207 148.9909 150.7130 152.4351 153.0091 153.5832 155.8793 158.1755 159.8976 162.1937 165.0639 166.7860 170.8043 177.1187 179.9888 180.5629 182.2850 183.4331 184.5811 185.7292 186.3032 186.3032 186.3032 186.3032 185.1552 184.5811 184.0071 183.4331 182.2850 180.5629 179.9888 178.8408 178.8408 177.6927 175.3966 173.6744 171.9523 171.9523 171.3783 170.8043 170.8043 170.2302];
yPos = [192.5152 193.0892 191.3671 190.2191 189.6450 187.9229 186.7748 185.6268 185.6268 183.9047 183.3306 181.6085 178.7383 177.0162 176.4422 175.8682 174.1460 173.5720 172.9980 171.8499 170.7018 169.5538 168.4057 166.6836 164.3874 162.0913 160.3692 159.2211 157.4990 157.4990 156.9249 155.7769 154.6288 153.4807 152.3327 151.7586 151.1846 150.6105 150.6105 150.6105 152.3327 154.0548 156.9249 158.0730 160.3692 163.8134 165.5355 167.2576 168.4057 170.7018 172.9980 174.7201 177.0162 178.7383 180.4604 181.6085 183.3306 184.4787 185.6268 186.2008 186.7748 187.9229 189.0710 189.0710 189.6450 189.6450 190.2191 190.2191 190.2191 190.7931 190.7931 190.7931 191.3671 191.3671];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [202.9503 200.0801 194.3398 193.7657 193.1917 193.1917 193.1917 193.1917 193.1917 193.7657 195.4878 197.7840 199.5061 201.2282 201.8022 202.9503 204.0984 205.2465 206.3945 207.5426 208.6907 212.1349 214.4310 216.7272 217.8753 217.8753 217.8753 218.4493 218.4493 219.0233 219.5974 219.5974 219.5974 219.5974 219.5974 219.5974 219.5974 219.5974 218.4493 215.5791 214.4310 213.2830 211.5609 209.8387 208.1166 206.3945 204.6724 204.0984 204.8311 204.4285];
yPos = [167.2576 159.2211 147.7404 146.5923 144.8702 143.7221 141.4260 139.1298 135.1116 132.8154 129.3712 126.5010 124.2049 122.4828 121.9087 121.3347 120.7606 120.1866 120.1866 120.1866 120.1866 120.1866 121.9087 123.6308 124.7789 126.5010 127.0751 127.0751 127.6491 129.3712 132.2414 135.1116 138.5558 142.5740 145.4442 147.1663 149.4625 152.3327 155.7769 158.0730 160.3692 161.5172 162.6653 163.8134 163.8134 164.3874 164.9615 164.9615 165.8702 165.8702];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [232.2262 229.3560 227.6339 223.6156 220.1714 217.3012 217.3012 217.3012 217.3012 217.3012 217.8753 220.1714 221.8935 221.8935 223.6156 230.5041 232.8002 233.3742 236.8185 238.5406 239.6886 242.5588 245.4290 246.5771 247.7252 247.7252 247.7252 248.2992 248.2992 248.2992 248.2992 248.2992 246.0030 244.2809 243.1329 241.9848 240.8367 237.9665 237.3925 236.8185 236.2444 235.6704 235.0963 234.5223 233.9483];
yPos = [179.3124 177.0162 174.7201 167.2576 158.6471 155.7769 153.4807 152.9067 150.6105 147.7404 144.2961 140.8519 139.7039 139.1298 138.5558 136.2596 136.2596 136.2596 136.2596 136.2596 136.2596 137.4077 142.0000 147.1663 152.3327 159.2211 164.9615 167.8316 168.4057 170.1278 172.9980 175.2941 176.4422 177.5903 179.3124 179.8864 179.8864 179.8864 179.8864 181.0345 181.0345 181.0345 181.0345 181.0345 181.0345];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [219.0233 218.4493 218.4493 217.3012 216.7272 216.1531 213.8570 212.1349 212.1349 212.1349 212.1349 212.1349 210.4128 209.8387 208.1166 207.5426 206.9686 205.8205 204.6724 202.9503 202.3763 202.3763 202.3763 202.3763 201.8022 201.8022 201.8022 201.8022 201.8022 202.3763 202.9503 203.5243 205.2465 206.3945 206.9686 207.5426 208.1166 209.2647 210.4128 212.1349 212.7089 214.4310 215.5791 217.3012 221.8935 228.2079 230.5041 231.0781 231.6521 232.8002 233.9483 233.9483 233.9483 233.9483 233.9483 233.3742 232.8002 232.2262 232.2262 230.5041 229.3560 228.2079 226.4858 225.3377 223.6156 223.0416 221.8935 221.3195 220.1714 219.5974 218.4493 216.1531 215.0051 212.7089 212.1349 210.9868 210.4128 209.8387 208.1166 206.9686 205.2465 204.6724 202.9503 202.3763 202.3763 201.2282 200.6542 200.0801 200.0801 200.0801 199.5061 199.5061 199.5061 199.5061 199.5061 199.5061 199.5061 201.2282 202.3763 203.5243 204.0984 205.8205 206.3945 208.1166 209.2647 210.4128 210.9868 211.5609 213.2830 215.0051 216.7272 217.3012 217.3012 217.3012 217.8753 217.8753 218.4493 219.0233 219.0233 219.5974];
yPos = [116.1684 116.1684 115.0203 111.5761 110.4280 106.4097 98.3732 94.3550 90.9108 89.7627 89.1886 88.6146 82.8742 82.3002 78.2819 76.5598 75.9858 75.9858 75.9858 75.9858 75.9858 79.4300 84.0223 86.3185 88.6146 90.3367 90.9108 92.6329 94.3550 96.0771 97.2252 98.3732 100.0953 102.3915 102.9655 104.1136 104.6876 105.8357 106.4097 107.5578 108.7059 108.7059 109.8540 110.4280 111.5761 112.1501 112.1501 112.1501 112.1501 112.1501 111.5761 110.4280 107.5578 106.9838 104.6876 102.3915 101.8174 101.2434 99.5213 97.7992 95.5030 93.2069 91.4848 89.7627 88.0406 86.8925 86.3185 85.1704 84.5963 84.0223 82.3002 80.5781 80.5781 79.4300 77.1339 76.5598 75.9858 75.9858 75.9858 75.9858 75.9858 75.9858 77.1339 78.2819 78.8560 79.4300 81.1521 81.7262 82.3002 82.8742 83.4483 84.0223 85.7444 87.4665 89.1886 90.9108 91.4848 94.3550 96.6511 98.3732 98.3732 99.5213 100.0953 101.8174 102.3915 102.9655 104.1136 104.1136 105.8357 108.1318 109.8540 111.0020 111.5761 112.1501 113.8722 114.4462 115.0203 115.5943 116.1684 116.1684];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [256.3357 255.7617 254.6136 252.8915 251.1694 250.5953 248.2992 247.1511 246.0030 246.0030 246.0030 246.0030 246.0030 247.1511 249.4473 253.4655 256.9097 260.3540 266.0943 270.1126 272.4087 274.1308 274.7049 275.2789 275.8529 275.8529 276.4270 276.4270 275.2789 273.5568 271.8347 270.1126 267.8164 264.9462 263.7982 262.0761 260.9280 259.7799 257.4838 253.4655 252.8915 252.3174 251.7434 251.1694 250.5953 250.0213 250.0213 250.0213 251.1090 250.7064];
yPos = [118.4645 118.4645 117.8905 115.5943 111.5761 111.0020 107.5578 104.6876 102.9655 100.6694 98.9473 97.2252 94.9290 92.6329 90.9108 89.7627 89.1886 88.6146 88.6146 88.6146 88.6146 88.6146 89.1886 90.9108 92.6329 97.2252 101.2434 104.6876 106.9838 108.7059 111.0020 113.8722 116.1684 118.4645 119.6126 120.1866 120.7606 120.7606 120.7606 120.1866 120.1866 119.6126 119.6126 119.0385 118.4645 117.8905 117.3164 116.7424 115.7013 115.2987];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [257.4838 257.4838 257.4838 257.4838 257.4838 257.4838 258.6318 259.7799 262.0761 263.7982 266.0943 267.8164 270.1126 274.1308 279.2972 283.3154 287.9077 291.3519 291.9260 292.5000 294.2221 295.9442 297.6663 300.5365 301.5000 301.5000 301.5000 301.5000 301.5000 301.5000 301.5000 301.5000 301.5000 301.5000 301.5000 301.5000 301.5000 301.5000 301.5000 301.5000 301.5000 301.5000 301.5000 301.5000 301.5000 301.5000 301.5000 301.5000 301.5000 301.5000 301.5000 300.5365 298.8144 295.9442 293.0740 291.3519 290.2039 288.4817 286.7596 285.6116 285.0375 283.3154 282.7414 281.0193 279.8712 278.7231 278.1491 277.5751 276.4270 275.2789 274.1308 273.5568 272.9828 271.8347 271.2606 270.1126 268.9645 268.3905 267.2424 265.5203 263.7982 262.6501 262.0761 261.5020 260.9280 260.3540 259.7799 259.7799 259.2059 258.6318 258.6318 258.0578 257.4838 257.4838 257.4838 257.4838 257.4838 257.4838 257.4838 257.4838 257.4838 257.4838 257.4838 256.9097 256.3357 255.2987 255.7013];
yPos = [85.1704 84.5963 83.4483 80.0041 75.9858 75.4118 71.3935 65.6531 61.0609 57.6166 55.3205 53.5984 52.4503 51.3022 50.7282 50.1542 50.1542 50.1542 50.1542 50.1542 50.1542 50.1542 50.1542 51.3022 53.5984 56.4686 59.3387 60.4868 62.2089 63.9310 66.2272 70.2454 73.1156 75.4118 77.7079 80.0041 81.7262 84.5963 87.4665 90.3367 93.2069 97.7992 101.8174 104.1136 105.2617 105.8357 106.4097 106.9838 108.1318 108.7059 109.8540 109.8540 109.8540 109.8540 109.8540 109.8540 109.8540 109.8540 109.8540 108.7059 108.1318 108.1318 108.1318 107.5578 106.9838 106.4097 106.4097 106.4097 106.4097 105.2617 104.6876 104.1136 104.1136 104.1136 103.5396 102.9655 101.8174 101.2434 100.0953 98.9473 97.7992 96.6511 96.6511 95.5030 94.9290 94.3550 93.2069 92.6329 92.0588 92.0588 90.9108 90.3367 89.7627 88.6146 87.4665 86.8925 86.3185 85.7444 85.1704 83.4483 82.8742 82.3002 81.7262 81.1521 81.1521 82.2987 82.7013];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [250.5953 251.7434 252.8915 254.6136 256.3357 258.6318 259.7799 262.0761 263.7982 264.3722 264.9462 265.5203 266.6684 267.2424 268.9645 271.2606 271.8347 272.9828 274.7049 275.2789 276.4270 278.1491 279.8712 282.7414 284.4635 285.0375 285.6116 285.6116 286.1856 286.7596 287.3337 287.3337 287.3337 287.9077 287.9077 287.9077 287.9077 287.9077 287.9077 287.9077 287.9077 287.9077 287.9077 287.9077 287.3337 286.7596 286.1856 285.6116 284.4635 283.8895 282.1673 280.4452 279.2972 278.1491 277.5751 277.0010 275.8529 273.5568 270.6866 266.6684 262.6501 260.9280 260.3540 259.2059 258.6318 257.4838 255.7617 254.0396 252.8915 251.7434 251.1694 250.0213 248.8732 248.8732 248.2992 248.2992 247.7252 247.7252 247.7252 247.7252 247.7252 247.7252 247.7252 247.7252 247.7252 247.7252 247.7252 247.7252 247.7252 247.7252 248.8732 250.0213 250.0213];
yPos = [258.5294 257.9554 257.9554 259.1034 260.8256 263.6957 265.9919 267.1400 269.4361 270.0101 270.5842 271.7323 272.3063 272.8803 273.4544 274.0284 274.0284 274.0284 274.0284 274.0284 274.0284 274.0284 274.0284 274.0284 274.0284 274.0284 273.4544 272.8803 272.8803 272.3063 271.1582 270.0101 267.7140 265.9919 264.2698 262.5477 261.9736 261.3996 259.6775 257.9554 257.3813 256.2333 254.5112 253.9371 252.7890 252.2150 251.6410 251.0669 249.9189 248.1968 247.0487 244.7525 243.6045 242.4564 241.8824 241.3083 240.7343 239.5862 239.0122 238.4381 237.8641 237.8641 237.8641 237.8641 237.8641 238.4381 239.5862 240.1602 241.3083 243.0304 243.0304 243.6045 244.7525 245.9006 247.0487 247.6227 248.1968 249.3448 249.9189 250.4929 251.0669 252.2150 252.7890 253.9371 254.5112 255.0852 256.2333 256.8073 257.3813 257.9554 258.5294 258.5294 259.1034];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [220.1714 219.5974 217.3012 213.2830 208.6907 205.8205 205.2465 204.6724 202.3763 200.6542 199.5061 198.9320 198.3580 197.7840 197.7840 197.2099 196.6359 196.6359 196.6359 196.6359 196.6359 196.6359 196.6359 196.6359 196.6359 196.6359 196.6359 196.6359 196.6359 196.6359 196.6359 196.6359 197.2099 198.9320 200.6542 201.8022 202.9503 205.2465 207.5426 210.4128 212.1349 213.8570 216.1531 217.3012 218.4493 220.1714 221.3195 223.0416 225.3377 227.6339 229.9300 231.6521 232.2262 233.3742 233.9483 234.5223 235.0963 236.2444 236.2444 236.2444 236.2444 236.2444 236.2444 236.2444 236.2444 235.0963 234.5223 233.9483 233.3742 232.8002 232.2262 231.6521 230.5041 229.9300 229.3560 228.7819 228.2079 227.6339 227.0598 225.9118 225.3377 223.6156 223.0416 222.4675 221.2987 221.7013];
yPos = [258.5294 259.1034 259.1034 259.1034 259.1034 258.5294 258.5294 258.5294 257.3813 256.8073 255.6592 255.6592 254.5112 253.9371 253.3631 252.7890 252.7890 251.6410 250.4929 249.3448 248.7708 247.0487 245.3266 243.6045 241.8824 240.1602 239.5862 237.8641 234.4199 232.1237 229.8276 228.1055 226.9574 225.8093 224.6613 223.5132 223.5132 222.9391 221.7911 221.2170 221.2170 221.2170 220.6430 220.6430 220.6430 220.6430 220.6430 220.6430 221.2170 222.9391 224.0872 225.8093 226.9574 228.1055 229.2535 230.9757 233.2718 236.1420 237.8641 240.1602 241.8824 243.0304 244.7525 245.9006 247.0487 249.3448 251.0669 252.7890 252.7890 253.3631 253.9371 255.0852 255.6592 256.2333 256.2333 256.2333 256.8073 256.8073 257.9554 257.9554 258.5294 258.5294 259.1034 259.1034 260.0000 260.0000];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [184.5811 185.1552 184.5811 182.8590 182.2850 181.1369 180.5629 180.5629 180.5629 179.9888 179.4148 179.4148 179.4148 179.4148 179.4148 179.4148 179.4148 179.4148 179.9888 180.5629 181.1369 181.7110 182.8590 183.4331 184.5811 185.7292 186.8773 189.1734 192.6176 197.2099 200.0801 200.0801 202.3763 204.6724 205.8205 207.5426 208.1166 208.6907 209.2647 209.8387 210.9868 212.1349 213.2830 213.2830 214.4310 215.0051 215.0051 216.1531 216.7272 216.7272 216.7272 217.3012 217.3012 217.3012 216.7272 216.7272 216.7272 215.5791 213.8570 213.2830 212.1349 211.5609 210.9868 209.8387 208.6907 208.1166 206.3945 205.8205 204.6724 200.6542 198.3580 196.6359 194.3398 193.1917 192.6176 192.0436 191.4696 190.8955 189.7475 189.1734 187.4513 186.8773];
yPos = [244.1785 240.7343 238.4381 235.5680 234.9939 232.1237 230.4016 229.8276 229.2535 227.5314 225.8093 223.5132 221.2170 220.6430 218.9209 217.7728 217.1988 216.6247 215.4767 215.4767 214.9026 214.9026 214.3286 213.7546 213.1805 212.0325 211.4584 210.3103 208.5882 207.4402 206.8661 206.2921 206.2921 208.0142 209.1623 210.8844 211.4584 212.0325 213.7546 214.3286 216.0507 217.1988 218.3469 218.9209 220.6430 221.7911 224.0872 225.2353 226.9574 227.5314 228.1055 229.2535 229.8276 230.4016 231.5497 232.1237 232.6978 233.8458 234.9939 236.1420 237.2901 238.4381 239.5862 240.7343 241.3083 241.8824 243.0304 243.0304 243.6045 243.6045 243.6045 243.6045 243.6045 243.6045 243.6045 243.6045 243.6045 243.6045 243.6045 243.6045 243.6045 242.4564];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [159.3235 158.7495 156.4533 155.8793 154.7312 153.5832 152.4351 152.4351 151.8611 151.8611 151.8611 151.8611 151.8611 151.8611 151.8611 151.8611 151.8611 153.5832 158.7495 159.8976 166.7860 175.3966 179.9888 180.5629 181.7110 184.0071 186.8773 189.7475 191.4696 193.7657 194.9138 196.6359 197.2099 198.3580 198.9320 200.6542 202.3763 203.5243 204.6724 206.3945 207.5426 209.8387 210.4128 211.5609 212.1349 213.2830 213.8570 214.4310 214.4310 214.4310 215.0051 215.5791 215.5791 215.5791 215.5791 215.5791 215.5791 215.5791 215.5791 215.5791 215.5791 215.5791 215.5791 215.5791];
yPos = [281.4909 281.4909 281.4909 280.9168 278.6207 275.1765 272.8803 272.3063 268.8621 263.1217 257.9554 255.0852 254.5112 252.7890 251.6410 250.4929 249.9189 247.0487 244.7525 244.1785 240.1602 237.2901 235.5680 235.5680 235.5680 235.5680 238.4381 241.3083 244.7525 247.0487 249.3448 251.0669 252.7890 253.3631 253.9371 255.0852 256.8073 257.9554 259.6775 260.8256 261.3996 262.5477 263.1217 263.1217 263.6957 264.2698 264.8438 265.4178 265.9919 266.5659 267.7140 268.2880 269.4361 270.5842 272.3063 274.0284 275.1765 276.8986 278.0467 279.1947 279.7688 280.9168 282.0649 283.2130];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [41.8283 41.8306 41.8306 40.6826 40.1085 38.9604 38.9604 38.3864 38.3864 37.8124 36.6643 34.9422 34.3682 32.0720 31.4980 30.3499 29.2018 28.6278 26.3316 24.6095 22.8874 21.1653 20.5913 19.4432 17.1471 14.8509 14.2769 13.1288 11.4067 9.6846 7.3884 5.6663 5.0923 4.5183 3.9442 3.3702 2.2221 1.0740 0.6846 0.6846 0.6846 0.6846 0.6846 0.6846 0.6846 0.6846 0.6823 0.8445 0.5000];
yPos = [283.5000 282.8848 280.5887 273.1262 267.3858 264.5156 263.9416 262.2195 261.6455 261.6455 261.6455 259.9233 259.9233 259.3493 258.7753 258.2012 258.2012 258.2012 258.2012 258.2012 258.2012 258.2012 258.2012 258.2012 258.2012 258.2012 258.2012 258.2012 258.2012 258.7753 259.3493 259.3493 260.4974 260.4974 260.4974 261.0714 262.7935 263.3676 263.9416 264.5156 265.6637 266.2378 266.8118 267.9599 268.5339 269.1079 269.1491 276.3354 282.8848];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

% Active contour with texture
iterations = 10;
BW = activecontour(gaborX, BW, iterations, 'Chan-Vese');

% Create masked image.
maskedImage = RGB;
maskedImage(repmat(~BW,[1 1 3])) = 0;
end

function gaborFeatures = createGaborFeatures(im)

if size(im,3) == 3
    im = prepLab(im);
end

im = im2single(im);

imageSize = size(im);
numRows = imageSize(1);
numCols = imageSize(2);

wavelengthMin = 4/sqrt(2);
wavelengthMax = hypot(numRows,numCols);
n = floor(log2(wavelengthMax/wavelengthMin));
wavelength = 2.^(0:(n-2)) * wavelengthMin;

deltaTheta = 45;
orientation = 0:deltaTheta:(180-deltaTheta);

g = gabor(wavelength,orientation);
gabormag = imgaborfilt(im(:,:,1),g);

for i = 1:length(g)
    sigma = 0.5*g(i).Wavelength;
    K = 3;
    gabormag(:,:,i) = imgaussfilt(gabormag(:,:,i),K*sigma);
end

% Increases liklihood that neighboring pixels/subregions are segmented together
X = 1:numCols;
Y = 1:numRows;
[X,Y] = meshgrid(X,Y);
featureSet = cat(3,gabormag,X);
featureSet = cat(3,featureSet,Y);
featureSet = reshape(featureSet,numRows*numCols,[]);

% Normalize feature set
featureSet = featureSet - mean(featureSet);
featureSet = featureSet ./ std(featureSet);

gaborFeatures = reshape(featureSet,[numRows,numCols,size(featureSet,2)]);

% Add color/intensity into feature set
gaborFeatures = cat(3,gaborFeatures,im);

end

function out = prepLab(in)

% Convert L*a*b* image to range [0,1]
out = in;
out(:,:,1) = in(:,:,1) / 100;  % L range is [0 100].
out(:,:,2) = (in(:,:,2) + 86.1827) / 184.4170;  % a* range is [-86.1827,98.2343].
out(:,:,3) = (in(:,:,3) + 107.8602) / 202.3382;  % b* range is [-107.8602,94.4780].

end
